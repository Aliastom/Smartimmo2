# ============================================================================
# Configuration OpenFisca pour SmartImmo (Production)
# ============================================================================
# Copier ce fichier dans .env et ajuster les valeurs

# URL de base de l'API OpenFisca-France
# - En développement local : http://localhost:2000
# - En production : https://openfisca.votre-domaine.com
OPENFISCA_BASE_URL=https://openfisca.votre-domaine.com

# Timeout pour les requêtes vers OpenFisca (en millisecondes)
# Défaut: 15000 (15 secondes)
# Augmenter si OpenFisca est lent ou distant
OPENFISCA_TIMEOUT_MS=15000

# TTL du cache OpenFisca (en heures)
# Défaut: 24 (1 jour)
# Les paramètres fiscaux changent rarement, un cache long est OK
OPENFISCA_CACHE_TTL_H=24

# Activer les logs détaillés OpenFisca (debug)
# Défaut: false
# Mettre à true pour débugger les problèmes de connexion
OPENFISCA_DEBUG=false

# ============================================================================
# Configuration Scraping Fiscal (Optionnel - valeurs par défaut OK)
# ============================================================================

# Seuil minimum de sections OK pour créer un brouillon
# Défaut: 2 (au moins IR et PS doivent être trouvés)
# MIN_SECTIONS_OK=2

# Seuils de confiance minimum pour publication
# Défaut: 0.8 (80%) pour IR et PS, 0.6 (60%) pour les autres
# MIN_CONFIDENCE_IR=0.8
# MIN_CONFIDENCE_PS=0.8
# MIN_CONFIDENCE_DEFAULT=0.6

# Rate limiting pour éviter le blocage des sources web (req/sec)
# Défaut: 1 (1 requête par seconde)
# SCRAPE_RATE_LIMIT=1

# Nombre de tentatives en cas d'échec
# Défaut: 3
# SCRAPE_MAX_RETRIES=3

# Délai entre les tentatives (en millisecondes)
# Défaut: 1000 (1 seconde)
# SCRAPE_RETRY_DELAY=1000

# User-Agent pour le scraping (éviter d'être bloqué)
# Défaut: SmartImmo/1.0 (+https://smartimmo.fr)
# SCRAPE_USER_AGENT="SmartImmo/1.0 (+https://smartimmo.fr)"

# ============================================================================
# Notes
# ============================================================================
# 
# 1. Sans OpenFisca configuré:
#    - Le module fonctionne en mode dégradé (scrapers web uniquement)
#    - Confiance max 80% au lieu de 100%
#    - Publication IR/PS nécessite ≥2 sources web concordantes
#
# 2. Avec OpenFisca configuré:
#    - Confiance 100% si OpenFisca + ≥1 source web concordante
#    - Publication IR/PS plus facile
#    - Meilleure fiabilité des données
#
# 3. Test de configuration:
#    - UI: Bouton "Vérifier OpenFisca" dans /admin/impots/parametres
#    - CLI: curl https://app.votre-domaine.com/api/admin/tax/openfisca/health?year=2025
#    - Direct: curl https://openfisca.votre-domaine.com/spec
#

